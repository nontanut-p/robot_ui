(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{114:function(e,t){},116:function(e,t){},156:function(e,t,n){"use strict";n.r(t);var c=n(0),s=n(25),a=n.n(s),o=(n(90),n(2)),r=n(45),l=n(3),i=n(1);var d=n(41),b=n.n(d),j=n(15),u=n.n(j),m=(n(139),{cpuUsage:0,ramUsage:0,battery:0,temp:0}),h=[],x={pc_status:m,connection_status:!1,stream_images:0,robot_location:h,camera_selection:1,get_path:!1,path_list:[]},g=null;new Promise((function(e,t){(g=u.a.connect("https://agv.mtec.or.th")).on("connect",(function(){console.log("socket connected")})),g.on("request_login",(function(){g.emit("login",{email:"pat",pass:"agrimtec"})})),g.on("auth",(function(e){g.emit("get_robot_list")})),g.on("unauth",(function(e){console.warn("cannot log in")})),g.on("get_robot_list",(function(e){e.peer||(console.log("undefine robot not peer"),console.log("socket ID",g.id)),e.length>0&&!p.peer?(p.connect(e[0].socket_id),x.connection_status=!0):(console.log("Error Here"),x.connection_status=!1)})),g.on("message",(function(e){var t=e.from,n=e.message;"offer"===n.type?(console.log("got offer"),p.createPeerConnection(t,e.auth_type,n)):n.candidate?p.add_candidtates(n):console.warn("unknown message")})),g.on("robot_leave",(function(e){console.log("robot_leave : "+e),p.socket_id==e?p.destroy():console.error("robot_leave : socket_id not match : "+p.socket_id+" / "+e)})),g.on("reject_call",(function(e){console.warn("reject_call")})),g.on("alert",(function(e){console.warn("alert : "+e),alert(e)}))}));var O,p={pcConfig:{iceServers:[{urls:"stun:stun.l.google.com:19302"}]},socket_id:null,candidates:[],peer:null,auth_type:null,b_connected:!1,timer_check_ready:null,connect:function(e){console.log("connect robot"),this.socket_id?console.warn("robot already exists"):(this.candidates=[],this.socket_id=e,g.emit("message",{to:e,message:{type:"call"}}))},disconnect:function(){console.log("disconnect robot"),this.peer&&this.send_peer({event:"bye"}),this.destroy()},destroy:function(){var e=this;this.socket_id&&(this.socket_id=null,setTimeout((function(){e.peer&&(e.peer.destroy(),e.peer=null)}),100),this.timer_check_ready&&(clearInterval(this.timer_check_ready),this.timer_check_ready=null))},send_peer:function(e){this.peer.send(JSON.stringify(e))},createPeerConnection:function(e,t,n){if(this.socket_id){var c=this;console.log("createPeerConnection"),c.socket_id=e,c.auth_type=t;var s=this.peer=new b.a({initiator:!1,config:this.pcConfig});s.on("error",(function(e){console.error(e)})),s.on("connect",(function(){console.log("peer connected"),x.connection_status=!0,c.b_connected=!0,c.timer_check_ready||(c.timer_check_ready=setInterval((function(){c.send_peer({event:"ready"})}),1e3))})),s.on("close",(function(){console.log("peer closed"),c.b_connected=!1,c.destroy()})),s.on("signal",(function(e){c.sendMessage(e)})),s.on("data",(function(e){try{e=JSON.parse(e)}catch(t){return void console.warn("cannot parse data")}if("ready"==e.event){c.timer_check_ready&&(clearInterval(c.timer_check_ready),c.timer_check_ready=null);try{setInterval((function(){return c.send_peer({event:"get_pc_status"})}),5e3),setInterval((function(){return c.send_peer({event:"stream"})}),50),setInterval((function(){!0===x.get_path&&(c.send_peer({event:"get_path"}),x.get_path=!1)}),500),setInterval((function(){return c.send_peer({event:"get_location"})}),500)}catch(n){console.log("loss connect")}}else"get_pc_status"==e.event?(m.cpuUsage=e.status.cpuUsage,m.ramUsage=e.status.ramUsage,m.battery=e.status.battery,m.temp=e.status.temp):"get_location"==e.event?x.robot_location=e.data:"stream"==e.event?(1===x.camera_selection?c.send_peer({event:"camera_1"}):2===x.camera_selection?c.send_peer({event:"camera_2"}):3===x.camera_selection?c.send_peer({event:"camera_3"}):c.send_peer({event:"camera_0"}),x.stream_images=e.base64):"path_list"==e.event?x.path_list=e.path_list:"get_path_list"==e.event?e.err?console.error(e.err):e.paths.length>0&&(console.log("data.path",e.paths),c.send_peer({event:"get_path",name:e.paths[0]})):"get_path"==e.event&&(console.log("got path"),e.err&&console.error(e.err))})),this.candidates.forEach((function(e){s.signal(e)})),s.signal(n)}else console.error("robot not connect")},sendMessage:function(e){var t={to:this.socket_id,message:e};try{console.log("send message : "+JSON.stringify(t))}catch(n){console.log("send message : [Circular]")}g.emit("message",t)},add_candidtates:function(e){console.log("got candidate"),this.socket_id?this.peer?this.peer.signal(e):this.candidates.push(e):console.error("no robot")}},f=x;var v=function(){var e=Object(c.useState)("OFF"),t=Object(o.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)("red"),r=Object(o.a)(a,2),l=r[0],d=r[1],b=Object(c.useState)("https://png.pngtree.com/element_our/20190530/ourlarge/pngtree-no-photo-selfie-icon-image_1267182.jpg"),j=Object(o.a)(b,2),u=(j[0],j[1]);return Object(c.useEffect)((function(){setInterval((function(){O=f.stream_images}),50)})),Object(i.jsxs)("div",{className:" border-2 max-w-xl mx-auto bg-white rounded-xl shadow-md overflow-hidden xl:max-w-2xl bg-gray-100",children:[Object(i.jsxs)("div",{className:"text-center pl-2 pt-2 uppercase tracking-tight text-lg text-blue-700 font-semibold ",children:["Camera",Object(i.jsx)("button",{onClick:function(e){e.preventDefault(),"OFF"===n?(s("ON"),d("green"),u("data:image/jpeg;base64,${Peer[2]}")):(s("OFF"),d("red"),u("https://png.pngtree.com/element_our/20190530/ourlarge/pngtree-no-photo-selfie-icon-image_1267182.jpg"))},className:"hover: transform hover:-translate-y-1 hover:scale-110  hover:text-black text-white font-semibold rounded-full bg-".concat(l,"-400  px-3\t"),children:n})]}),Object(i.jsxs)("div",{children:[Object(i.jsx)("div",{className:"px-3 py-3 ",children:Object(i.jsx)("div",{className:"photo",children:Object(i.jsx)("img",{className:"img",src:"OFF"==n?"https://www.pngitem.com/pimgs/m/674-6740802_web-cam-camera-off-webcam-off-icon-png.png":"data:image/jpeg;base64,".concat(O)})})}),Object(i.jsxs)("div",{className:"px-2 grid grid-cols-4 gap-4 pb-2",children:[Object(i.jsxs)("button",{onClick:function(){f.camera_selection=1},className:"hover: transform hover:-translate-y-1 hover:scale-110  hover:text-black text-white font-semibold rounded-full bg-green-400",children:[" ","Camera 1"]}),Object(i.jsx)("button",{onClick:function(){f.camera_selection=2},className:"hover: transform hover:-translate-y-1 hover:scale-110  hover:text-black  text-white font-semibold rounded-full bg-green-400",children:"Camera 2"}),Object(i.jsx)("button",{onClick:function(){f.camera_selection=3},className:"hover: transform hover:-translate-y-1 hover:scale-110 hover:text-black   text-white font-semibold rounded-full bg-green-400",children:"Camera 3"}),Object(i.jsx)("button",{onClick:function(){f.camera_selection=4},className:"hover: transform hover:-translate-y-1 hover:scale-110  hover:text-black text-white font-semibold rounded-full bg-green-400",children:"Camera 4"})]})]})]})},_=n(159),S=n(160),y=n(83),N=n.n(y),w=n(6),k=n.n(w),C=(n(141),[]);var T=function(){Object(c.useEffect)((function(){setInterval((function(){C=f.robot_location}),500)}),0);var e=k.a.Icon.extend({options:{}}),t=(new e({iconUrl:"https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|abcdef&chf=a,s,ee00FFFF"}),new e({iconUrl:"https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|2ecc71&chf=a,s,ee00FFFF"}),[[14.078475654188983,100.6021117284084],[14.079475654188983,100.6022117284084]]),n=(C.length>2&&C[C.length-1],C.length>2?[C[C.length-2],C[C.length-1]]:t),s=C.length<1?t:C;return Object(i.jsxs)(_.a,{className:"rounded-xl border-2 \t",center:[14.078475654188983,100.6021117284084],zoom:17,maxZoom:25,scrollWheelZoom:!0,children:[Object(i.jsx)(N.a,{apiKey:"AIzaSyDDpue4GPm1L6-n5E5PCdzVHYXc0FW3N48",type:"satellite",maxZoom:25}),Object(i.jsx)(S.a,{pathOptions:{color:"lime"},positions:s,weight:5}),Object(i.jsx)(S.a,{pathOptions:{color:"red"},positions:n,weight:7})]})},E=n(85);var I=function(e){var t=e.text;return Object(i.jsx)("div",{className:" border my-0.5 text-gray-600 border-gray-400 rounded-xl  max-w-xl mx-auto bg-whiteshadow-md overflow-hidden xl:max-w-2xl bg-yellow-50  ",children:Object(i.jsxs)("p",{className:"font-light ml-4",children:[" ",Object(i.jsx)("span",{className:"text-red-400 ",children:"Robot:"})," ",t]})})},F=u()();var R=function(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(null),r=Object(o.a)(a,2),l=r[0],d=r[1],b=Object(c.useState)(""),j=Object(o.a)(b,2),u=j[0],m=j[1];return Object(i.jsx)("div",{className:"container",children:l?Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("ul",{}),Object(i.jsx)("input",{type:"text",value:n,onChange:function(e){s(e.target.value)}}),Object(i.jsx)("button",{onClick:function(){F.emit("message","".concat((new Date).toLocaleString()," : ").concat(n)),s("")},children:"SEND"})]}):Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("label",{for:"display-name",children:"Display Name"}),Object(i.jsx)("br",{}),Object(i.jsx)("input",{type:"text",value:u,onChange:function(e){m(e.target.value)}}),Object(i.jsx)("button",{onClick:function(){d(u)},children:"SUBMIT"})]})})},A=u()();var P,U=function(){var e=Object(c.useState)(["Driver ERROR","GPS DOWN","Battery dead","Motor head","Boomb","Boomb","GPS DOWN","Battery dead","Motor head","Boomb","Boomb"]),t=Object(o.a)(e,2),n=t[0],s=t[1];return Object(c.useEffect)((function(){A.on("test",(function(e){console.log(e),s((function(t){return[].concat(Object(E.a)(t),[e])}))}))}),[]),Object(i.jsxs)("div",{className:"mt-5  h-80 border-2 max-w-xl mx-auto max-h-80 bg-white w-full rounded-xl shadow-md xl:max-w-2xl h-2/3 bg-gray-100",children:[Object(i.jsx)("div",{className:"text-center pl-2 pt-2 uppercase tracking-tight text-lg text-blue-700 font-semibold ",children:"ROBOT MESSAGE"}),Object(i.jsx)("div",{className:"h-5/6 overflow-y-auto mb-10",children:Object(i.jsx)("ul",{children:n.map((function(e){return Object(i.jsx)(I,{text:e})}))})})]})},D=n(84);var B=function(e){var t=Object(c.useState)(""),n=Object(o.a)(t,2),s=n[0],a=n[1],r=Object(c.useState)(""),l=Object(o.a)(r,2),d=l[0],b=l[1],j=Object(c.useState)("Start"),u=Object(o.a)(j,2),m=u[0],h=u[1],x=Object(c.useState)("Start"),g=Object(o.a)(x,2),O=g[0],p=g[1],v=Object(c.useState)("Start"),_=Object(o.a)(v,2),S=_[0],y=_[1],N=Object(c.useState)("Select PATH "),w=Object(o.a)(N,2),k=w[0],C=w[1],T=Object(c.useState)([]),E=Object(o.a)(T,2),I=E[0],F=E[1],R=Object(c.useState)(!1),A=Object(o.a)(R,2),U=(A[0],A[1]),B=Object(c.useState)([{value:"test",label:"test"}]),L=Object(o.a)(B,2),M=L[0],G=L[1],W=[],Y=Object(c.useState)([]),J=Object(o.a)(Y,2),H=J[0],K=J[1];Object(c.useEffect)((function(){setInterval((function(){try{P=f.robot_location[0],a(P[0].toString()),b(P[1].toString())}catch(e){a("100.00"),b("100.00")}}),2e3)}),0);var z=Object(c.useState)(),V=Object(o.a)(z,2),Z=(V[0],V[1],[]),q={},X=0,$=function e(){f.get_path=!0,U(!0);var t=f.path_list;t=Object.values(t),F(t),function(e){e=e;for(var t=0;t<e.length;t++){Z=e[t].split("/"),console.log(Z),Z=Z[Z.length-1],console.log(Z),Z=Z.split(".path")[0],console.log(Z);var n=Z;Z={value:Z,label:Z},W.push(Z),console.log(n,"test text string"),q[n]=String(e[t]),K(q)}G(W)}(I),0===t.length&&X<=3?(X++,setTimeout((function(){e()}),1e3)):t.length>0&&(X=0)};return Object(i.jsx)(i.Fragment,{children:Object(i.jsxs)("div",{className:"mt-5  border-2 max-w-xl mx-auto bg-white w-full rounded-xl shadow-md xl:max-w-2xl h-2/3 bg-gray-100  overflow-y-auto ",children:[Object(i.jsx)("div",{className:"text-center pl-2 pt-2 uppercase tracking-tight text-lg text-blue-700 font-semibold ",children:"POSITION AND COMMAND"}),Object(i.jsxs)("div",{className:" grid grid-cols-2  sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 ",children:[Object(i.jsx)("div",{className:"border-2 bg-blue-100 pl-3 rounded-md mx-2 my-2 text-blue-600 font-semibold ",children:Object(i.jsxs)("p",{children:["LAT : ",Object(i.jsxs)("span",{className:"text-gray-600 font-light",children:[" ",s.slice(0,8)," "]})," "]})}),Object(i.jsx)("div",{className:"border-2 bg-blue-100 pl-3 rounded-md mx-2 my-2 text-blue-600 font-semibold ",children:Object(i.jsxs)("p",{children:["LON : ",Object(i.jsxs)("span",{className:"text-gray-600 font-light",children:[" ",d.slice(0,8)," "]})," "]})}),Object(i.jsx)("div",{className:"border-2 bg-blue-100 pl-3 rounded-md mx-2 my-2 text-blue-600 font-semibold ",children:Object(i.jsx)("button",{className:"font-bold hover:text-red-500 ",onClick:function(){return $()},children:" GET PATH LIST "})}),Object(i.jsx)("div",{className:"border-2 bg-blue-100 pl-3 rounded-md mx-2 my-2 text-blue-600 font-semibold ",children:Object(i.jsx)(D.a,{defaultValue:k,onChange:function(e){console.log(e.value,"On change wth option"),console.log(H[e.value],"js object"),C(e.value)},options:M})}),Object(i.jsx)("div",{className:"border-2 bg-blue-100 pl-3 rounded-md mx-2 my-2 text-blue-600 font-semibold ",children:"Start"==O?Object(i.jsx)("button",{className:"text-green-600 font-semibold",onClick:function(){return p("Stop")},children:" START FOLLOW "}):Object(i.jsx)("button",{onClick:function(){return p("Start")},className:"font-semibold text-red-600",children:" STOP FOLLOW "})}),Object(i.jsx)("div",{className:"border-2 bg-blue-100 pl-3 rounded-md mx-2 my-2 text-blue-600 font-semibold ",children:"Start"==m?Object(i.jsx)("button",{className:"text-green-600 font-semibold",onClick:function(){return h("Stop")},children:" START RECORD "}):Object(i.jsx)("button",{onClick:function(){return h("Start")},className:"font-semibold text-red-600",children:" STOP RECORD "})}),Object(i.jsx)("div",{className:"border-2 bg-blue-100 pl-3 rounded-md mx-2 my-2 text-blue-600 font-semibold ",children:"Start"==S?Object(i.jsx)("button",{className:"text-green-600 font-semibold",onClick:function(){return y("Stop")},children:" ENABLE SPRAY "}):Object(i.jsx)("button",{onClick:function(){return y("Start")},className:"font-semibold text-red-600",children:" DISABLE SPRAY "})})]})]})})};u()();var L=function(){return Object(i.jsxs)("div",{className:"mt-5  h-80 border-2 max-w-xl mx-auto max-h-80 bg-white w-full rounded-xl shadow-md xl:max-w-2xl h-2/3 bg-gray-100",children:[Object(i.jsx)("div",{className:"text-center border-5  pl-3 rounded-sm mx-2 my-2 text-blue-600 font-semibold hover:bg-sky-700",children:"ROBOT LOG"}),Object(i.jsx)("div",{className:"h-5/6 overflow-y-auto mb-10"})]})};u()();var M=function(){return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)("div",{className:"2xl:px-10 grid grid-cols-1 md:grid-cols-1 md:max-h-xl  mt-2  lg:grid-cols-2",children:[Object(i.jsx)(v,{}),Object(i.jsx)(T,{})]}),Object(i.jsxs)("div",{className:"2xl:px-10 grid grid-cols-1 md:grid-cols-1 md:max-h-xl  mt-2 gap-1 lg:grid-cols-3",children:[Object(i.jsx)(U,{}),Object(i.jsx)(L,{}),Object(i.jsx)(B,{})]})]})};var G=function(e){var t=(new Date).toLocaleTimeString();return Object(i.jsxs)("div",{className:"border-2 max-w-xl mx-auto bg-white rounded-xl shadow-md overflow-hidden xl:max-w-2xl",children:[Object(i.jsxs)("div",{className:"text-center pl-2 pt-2 uppercase tracking-tight text-sm md:text-md text-blue-700 font-semibold",children:["CONNECTION STATUS : ",Object(i.jsxs)("span",{class:1==e.connectStatus?"text-green-500 ":"text-red-500 ",children:[" ",1==e.connectStatus?"Online":"Offline"," "]}),"    TIME : ",Object(i.jsxs)("span",{className:"text-green-500",children:[" ",t]})]}),Object(i.jsxs)("div",{className:"grid grid-cols-2 pb-3",children:[Object(i.jsx)("div",{className:"pl-5 pt-2 text-sm text-blue-700 font-light md:text-md ",children:Object(i.jsxs)("ul",{children:[Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-trailer"})," ROBOT MODE :"," ",Object(i.jsx)("span",{class:"text-green-400 ",children:" Auto "})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-bolt"})," DRIVER :"," ",Object(i.jsx)("span",{class:"text-green-400 ",children:"test"})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-video"})," CAMERA :"," ",Object(i.jsx)("span",{class:"text-red-400 ",children:" NOT WORKING "})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-tint"})," SPRAY :"," ",Object(i.jsx)("span",{class:"text-green-400 ",children:" WORKING "})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-gamepad"})," JOYSTICK :"," ",Object(i.jsx)("span",{class:"text-red-400 ",children:" NOT WORKING "})]})]})}),Object(i.jsx)("div",{className:"pt-2 text-sm md:text-md text-blue-700 font-light pl-10 ",children:Object(i.jsxs)("ul",{children:[Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-microchip"})," CPU USAGE :"," ",Object(i.jsxs)("span",{class:"text-red-400 ",children:[" ",e.hardwareStatus[0].cpuUsage,"% "]})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-memory"})," RAM USAGE :"," ",Object(i.jsxs)("span",{class:"text-red-400 ",children:[" ",e.hardwareStatus[0].ramUsage,"MB "]})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-car-battery"})," BATTERY :"," ",Object(i.jsxs)("span",{class:"text-green-400 ",children:[" ",e.hardwareStatus[0].battery,"% "]})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-temperature-low"})," TEMPERATURE :"," ",Object(i.jsxs)("span",{class:"text-green-400 ",children:[" ",e.hardwareStatus[0].temp,"\xb0C "]})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-tint"})," SPRAY SHOTS :"," ",Object(i.jsx)("span",{class:"text-red-400 ",children:" 321/10000 "})]})]})})]})]})};var W=function(){var e=Object(c.useState)([{cpuUsage:0,ramUsage:0,battery:0,temp:0}]),t=Object(o.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(!1),d=Object(o.a)(a,2),b=d[0],j=d[1],u=Object(c.useState)(),m=Object(o.a)(u,2);return m[0],m[1],Object(c.useEffect)((function(){setInterval((function(){s([{cpuUsage:f.pc_status.cpuUsage,ramUsage:f.pc_status.ramUsage,battery:f.pc_status.battery,temp:f.pc_status.temp}]),j(f.connection_status)}),500)}),0),Object(i.jsx)(r.a,{children:Object(i.jsxs)(l.c,{children:[Object(i.jsxs)(l.a,{exact:!0,path:"/",children:[" ",Object(i.jsx)("div",{}),Object(i.jsx)(G,{hardwareStatus:n,connectStatus:b}),Object(i.jsx)(M,{})]}),Object(i.jsx)(l.a,{exact:!0,path:"/map",children:Object(i.jsx)(T,{})}),Object(i.jsx)(l.a,{exact:!0,path:"/test",children:Object(i.jsx)(R,{})})]})})},Y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,161)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),c(e),s(e),a(e),o(e)}))};a.a.render(Object(i.jsx)(W,{}),document.getElementById("root")),Y()},90:function(e,t,n){}},[[156,1,2]]]);
//# sourceMappingURL=main.e783230c.chunk.js.map