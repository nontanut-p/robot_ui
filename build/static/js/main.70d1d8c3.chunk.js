(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{114:function(e,t){},116:function(e,t){},156:function(e,t,s){"use strict";s.r(t);var c=s(0),n=s(25),o=s.n(n),a=(s(90),s(2)),r=s(45),l=s(3),i=s(1);var d=s(41),b=s.n(d),j=s(20),u=s.n(j),m=(s(139),{cpuUsage:0,ramUsage:0,battery:0,temp:0}),h=[],x={pc_status:m,connection_status:!1,stream_images:0,robot_location:h,camera_selection:1,get_path:!1,path_list:[],follow_mode:{state_follow:!1,path_follow:"",following:!1},rosout:""},g=null;new Promise((function(e,t){(g=u.a.connect("https://agv.mtec.or.th")).on("connect",(function(){console.log("socket connected")})),g.on("request_login",(function(){g.emit("login",{email:"pat",pass:"agrimtec"})})),g.on("auth",(function(e){g.emit("get_robot_list")})),g.on("unauth",(function(e){console.warn("cannot log in")})),g.on("get_robot_list",(function(e){e.peer||(console.log("undefine robot not peer"),console.log("socket ID",g.id)),e.length>0&&!p.peer?(p.connect(e[0].socket_id),x.connection_status=!0):(console.log("Error Here"),x.connection_status=!1)})),g.on("message",(function(e){var t=e.from,s=e.message;"offer"===s.type?(console.log("got offer"),p.createPeerConnection(t,e.auth_type,s)):s.candidate?p.add_candidtates(s):console.warn("unknown message")})),g.on("robot_leave",(function(e){console.log("robot_leave : "+e),p.socket_id==e?p.destroy():console.error("robot_leave : socket_id not match : "+p.socket_id+" / "+e)})),g.on("reject_call",(function(e){console.warn("reject_call")})),g.on("alert",(function(e){console.warn("alert : "+e),alert(e)}))}));var O,p={pcConfig:{iceServers:[{urls:"stun:stun.l.google.com:19302"}]},socket_id:null,candidates:[],peer:null,auth_type:null,b_connected:!1,timer_check_ready:null,connect:function(e){console.log("connect robot"),this.socket_id?console.warn("robot already exists"):(this.candidates=[],this.socket_id=e,g.emit("message",{to:e,message:{type:"call"}}))},disconnect:function(){console.log("disconnect robot"),this.peer&&this.send_peer({event:"bye"}),this.destroy()},destroy:function(){var e=this;this.socket_id&&(this.socket_id=null,setTimeout((function(){e.peer&&(e.peer.destroy(),e.peer=null)}),100),this.timer_check_ready&&(clearInterval(this.timer_check_ready),this.timer_check_ready=null))},send_peer:function(e){try{this.peer.send(JSON.stringify(e))}catch(t){console.log(t)}},createPeerConnection:function(e,t,s){if(this.socket_id){var c=this;console.log("createPeerConnection"),c.socket_id=e,c.auth_type=t;var n=this.peer=new b.a({initiator:!1,config:this.pcConfig});n.on("error",(function(e){console.error(e)})),n.on("connect",(function(){console.log("peer connected"),x.connection_status=!0,c.b_connected=!0,c.timer_check_ready||(c.timer_check_ready=setInterval((function(){c.send_peer({event:"ready"})}),1e3))})),n.on("close",(function(){console.log("peer closed"),c.b_connected=!1,c.destroy()})),n.on("signal",(function(e){c.sendMessage(e)})),n.on("data",(function(e){try{e=JSON.parse(e)}catch(t){return void console.warn("cannot parse data")}if("ready"==e.event){c.timer_check_ready&&(clearInterval(c.timer_check_ready),c.timer_check_ready=null);try{setInterval((function(){return c.send_peer({event:"get_pc_status"})}),5e3),setInterval((function(){return c.send_peer({event:"stream"})}),50),setInterval((function(){!0===x.get_path&&(c.send_peer({event:"get_path"}),x.get_path=!1),1==x.follow_mode.state_follow&&(c.send_peer({event:"start_follow",path:x.follow_mode.path_follow}),x.follow_mode.state_follow=!1)}),500)}catch(s){console.log("loss connect")}}else"get_pc_status"==e.event?(m.cpuUsage=e.status.cpuUsage,m.ramUsage=e.status.ramUsage,m.battery=e.status.battery,m.temp=e.status.temp):"get_location"==e.event?x.robot_location=e.data:"get_rosout"==e.event?(x.rosout=e.message,console.log("rosout",e.message)):"stream"==e.event?(1===x.camera_selection?c.send_peer({event:"camera_1"}):2===x.camera_selection?c.send_peer({event:"camera_2"}):3===x.camera_selection?c.send_peer({event:"camera_3"}):c.send_peer({event:"camera_0"}),x.stream_images=e.base64):"path_list"==e.event?x.path_list=e.path_list:"start_follow"===e.event?console.log(e.status):"get_path_list"==e.event?e.err?console.error(e.err):e.paths.length>0&&(console.log("data.path",e.paths),c.send_peer({event:"get_path",name:e.paths[0]})):"get_path"==e.event&&(console.log("got path"),e.err&&console.error(e.err))})),this.candidates.forEach((function(e){n.signal(e)})),n.signal(s)}else console.error("robot not connect")},sendMessage:function(e){var t={to:this.socket_id,message:e};try{console.log("send message : "+JSON.stringify(t))}catch(s){console.log("send message : [Circular]")}g.emit("message",t)},add_candidtates:function(e){console.log("got candidate"),this.socket_id?this.peer?this.peer.signal(e):this.candidates.push(e):console.error("no robot")}},f=x;var v=function(){var e=Object(c.useState)("OFF"),t=Object(a.a)(e,2),s=t[0],n=t[1],o=Object(c.useState)("red"),r=Object(a.a)(o,2),l=r[0],d=r[1],b=Object(c.useState)("https://png.pngtree.com/element_our/20190530/ourlarge/pngtree-no-photo-selfie-icon-image_1267182.jpg"),j=Object(a.a)(b,2),u=(j[0],j[1]);return Object(c.useEffect)((function(){setInterval((function(){O=f.stream_images}),50)})),Object(i.jsxs)("div",{className:" border-2 max-w-xl mx-auto bg-white rounded-xl shadow-md overflow-hidden xl:max-w-2xl bg-gray-100",children:[Object(i.jsxs)("div",{className:"text-center pl-2 pt-2 uppercase tracking-tight text-lg text-blue-700 font-semibold ",children:["Camera",Object(i.jsx)("button",{onClick:function(e){e.preventDefault(),"OFF"===s?(n("ON"),d("green"),u("data:image/jpeg;base64,${Peer[2]}")):(n("OFF"),d("red"),u("https://png.pngtree.com/element_our/20190530/ourlarge/pngtree-no-photo-selfie-icon-image_1267182.jpg"))},className:"hover: transform hover:-translate-y-1 hover:scale-110  hover:text-black text-white font-semibold rounded-full bg-".concat(l,"-400  px-3\t"),children:s})]}),Object(i.jsxs)("div",{children:[Object(i.jsx)("div",{className:"px-3 py-3 ",children:Object(i.jsx)("div",{className:"photo",children:Object(i.jsx)("img",{className:"img",src:"OFF"==s?"https://www.pngitem.com/pimgs/m/674-6740802_web-cam-camera-off-webcam-off-icon-png.png":"data:image/jpeg;base64,".concat(O)})})}),Object(i.jsxs)("div",{className:"px-2 grid grid-cols-4 gap-4 pb-2",children:[Object(i.jsxs)("button",{onClick:function(){f.camera_selection=1},className:"hover: transform hover:-translate-y-1 hover:scale-110  hover:text-black text-white font-semibold rounded-full bg-green-400",children:[" ","Camera 1"]}),Object(i.jsx)("button",{onClick:function(){f.camera_selection=2},className:"hover: transform hover:-translate-y-1 hover:scale-110  hover:text-black  text-white font-semibold rounded-full bg-green-400",children:"Camera 2"}),Object(i.jsx)("button",{onClick:function(){f.camera_selection=3},className:"hover: transform hover:-translate-y-1 hover:scale-110 hover:text-black   text-white font-semibold rounded-full bg-green-400",children:"Camera 3"}),Object(i.jsx)("button",{onClick:function(){f.camera_selection=4},className:"hover: transform hover:-translate-y-1 hover:scale-110  hover:text-black text-white font-semibold rounded-full bg-green-400",children:"Camera 4"})]})]})]})},_=s(159),w=s(160),y=s(83),S=s.n(y),N=s(6),k=s.n(N),C=(s(141),[]);var E=function(){Object(c.useEffect)((function(){setInterval((function(){C=f.robot_location}),500)}),0);var e=k.a.Icon.extend({options:{}}),t=(new e({iconUrl:"https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|abcdef&chf=a,s,ee00FFFF"}),new e({iconUrl:"https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|2ecc71&chf=a,s,ee00FFFF"}),[[14.078475654188983,100.6021117284084],[14.079475654188983,100.6022117284084]]),s=(C.length>2&&C[C.length-1],C.length>2?[C[C.length-2],C[C.length-1]]:t),n=C.length<1?t:C;return Object(i.jsxs)(_.a,{className:"rounded-xl border-2 \t",center:[14.078475654188983,100.6021117284084],zoom:17,maxZoom:25,scrollWheelZoom:!0,children:[Object(i.jsx)(S.a,{apiKey:"AIzaSyDDpue4GPm1L6-n5E5PCdzVHYXc0FW3N48",type:"satellite",maxZoom:25}),Object(i.jsx)(w.a,{pathOptions:{color:"lime"},positions:n,weight:5}),Object(i.jsx)(w.a,{pathOptions:{color:"red"},positions:s,weight:7})]})},R=s(85);var A=function(e){var t=e.text,s=e.warn,c=e.error;return Object(i.jsx)("div",{className:" border my-0.5 text-gray-600 border-gray-400 rounded-xl  max-w-xl mx-auto bg-whiteshadow-md overflow-hidden xl:max-w-2xl bg-yellow-50  ",children:Object(i.jsxs)("p",{className:"font-light ml-4",children:[" ",Object(i.jsxs)("span",{className:"text-red-400 ",children:[t,":"]})," ERROR: ",c,"  WARN:  ",s," "]})})},T=u()();var F=function(){var e=Object(c.useState)(""),t=Object(a.a)(e,2),s=t[0],n=t[1],o=Object(c.useState)(null),r=Object(a.a)(o,2),l=r[0],d=r[1],b=Object(c.useState)(""),j=Object(a.a)(b,2),u=j[0],m=j[1];return Object(i.jsx)("div",{className:"container",children:l?Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("ul",{}),Object(i.jsx)("input",{type:"text",value:s,onChange:function(e){n(e.target.value)}}),Object(i.jsx)("button",{onClick:function(){T.emit("message","".concat((new Date).toLocaleString()," : ").concat(s)),n("")},children:"SEND"})]}):Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("label",{for:"display-name",children:"Display Name"}),Object(i.jsx)("br",{}),Object(i.jsx)("input",{type:"text",value:u,onChange:function(e){m(e.target.value)}}),Object(i.jsx)("button",{onClick:function(){d(u)},children:"SUBMIT"})]})})},M=u()();var I,U=function(){var e=Object(c.useState)(["Driver ERROR","GPS DOWN","Battery dead","Motor head","Boomb","Boomb","GPS DOWN","Battery dead","Motor head","Boomb","Boomb"]),t=Object(a.a)(e,2),s=(t[0],t[1]);return Object(c.useEffect)((function(){M.on("test",(function(e){console.log(e),s((function(t){return[].concat(Object(R.a)(t),[e])}))}))}),[]),Object(i.jsxs)("div",{className:"mt-5  h-80 border-2 max-w-xl mx-auto max-h-80 bg-white w-full rounded-xl shadow-md xl:max-w-2xl h-2/3 bg-gray-100",children:[Object(i.jsx)("div",{className:"text-center pl-2 pt-2 uppercase tracking-tight text-lg text-blue-700 font-semibold ",children:"ROBOT MESSAGE"}),Object(i.jsxs)("div",{className:"h-5/6 overflow-y-auto mb-10",children:[Object(i.jsx)(A,{text:"Motor 1 ",warn:"Motor boombbb!!",error:"Drive's on fire"}),Object(i.jsx)(A,{text:"Motor 2"}),Object(i.jsx)(A,{text:"Motor 3"}),Object(i.jsx)(A,{text:"Motor 4"}),Object(i.jsx)(A,{text:"Motor 5"}),Object(i.jsx)(A,{text:"Motor 6"}),Object(i.jsx)(A,{text:"Motor 7"}),Object(i.jsx)(A,{text:"Motor 8"})]})]})},P=s(84);var D=function(e){var t=Object(c.useState)(""),s=Object(a.a)(t,2),n=s[0],o=s[1],r=Object(c.useState)(""),l=Object(a.a)(r,2),d=l[0],b=l[1],j=Object(c.useState)("Start"),u=Object(a.a)(j,2),m=u[0],h=u[1],x=Object(c.useState)("Start"),g=Object(a.a)(x,2),O=g[0],p=g[1],v=Object(c.useState)("Select PATH "),_=Object(a.a)(v,2),w=_[0],y=_[1],S=Object(c.useState)(),N=Object(a.a)(S,2),k=N[0],C=N[1],E=Object(c.useState)(!1),R=Object(a.a)(E,2),A=(R[0],R[1]),T=Object(c.useState)([{value:"test",label:"test"}]),F=Object(a.a)(T,2),M=F[0],U=F[1],D=Object(c.useState)("START FOLLOW"),B=Object(a.a)(D,2),L=B[0],G=(B[1],[]),W=Object(c.useState)([]),Y=Object(a.a)(W,2),H=Y[0];Y[1],Object(c.useEffect)((function(){setInterval((function(){try{I=f.robot_location[0],o(I[0].toString()),b(I[1].toString())}catch(e){o((100*Math.random()).toString()),b((100*Math.random()).toString())}}),2e3)}),0);var J=Object(c.useState)(),z=Object(a.a)(J,2),K=(z[0],z[1],[]),Z=function(){f.get_path=!0,A(!0),C(f.path_list),function(e){try{e=Object.keys(e);for(var t=0;t<Object.keys(e).length;t++)K=e[t],console.log(K),K={value:K,label:K},G.push(K)}catch(s){console.log(s)}U(G)}(k)};return Object(i.jsx)(i.Fragment,{children:Object(i.jsxs)("div",{className:"mt-5  border-2 max-w-xl mx-auto bg-white w-full rounded-xl shadow-md xl:max-w-2xl h-2/3 bg-gray-100  overflow-y-auto ",children:[Object(i.jsx)("div",{className:"text-center pl-2 pt-2 uppercase tracking-tight text-lg text-blue-700 font-semibold ",children:"POSITION AND COMMAND"}),Object(i.jsxs)("div",{className:" grid grid-cols-2  sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 ",children:[Object(i.jsx)("div",{className:"border-2 bg-blue-100 pl-3 rounded-md mx-2 my-2 text-blue-600 font-semibold ",children:Object(i.jsxs)("p",{children:["LAT : ",Object(i.jsxs)("span",{className:"text-gray-600 font-light",children:[" ",n.slice(0,8)," "]})," "]})}),Object(i.jsx)("div",{className:"border-2 bg-blue-100 pl-3 rounded-md mx-2 my-2 text-blue-600 font-semibold ",children:Object(i.jsxs)("p",{children:["LON : ",Object(i.jsxs)("span",{className:"text-gray-600 font-light",children:[" ",d.slice(0,8)," "]})," "]})}),Object(i.jsx)("div",{className:"border-2 bg-blue-100 pl-3 rounded-md mx-2 my-2 text-blue-600 font-semibold ",children:Object(i.jsx)("button",{className:"font-bold hover:text-red-500 ",onClick:function(){return Z()},children:" GET PATH LIST "})}),Object(i.jsx)("div",{className:"border-2 bg-blue-100 pl-3 rounded-md mx-2 my-2 text-blue-600 font-semibold ",children:Object(i.jsx)(P.a,{defaultValue:w,onChange:function(e){console.log(e.value,"On change wth option"),console.log(H[e.value],"js object"),y(e.value)},options:M})}),Object(i.jsx)("div",{className:"border-2 bg-blue-100 pl-3 rounded-md mx-2 my-2 text-blue-600 font-semibold ",children:Object(i.jsx)("button",{onClick:function(){f.follow_mode.state_follow=!0,f.follow_mode.path_follow=w},children:L})}),Object(i.jsx)("div",{className:"border-2 bg-blue-100 pl-3 rounded-md mx-2 my-2 text-blue-600 font-semibold ",children:"Start"==m?Object(i.jsx)("button",{className:"text-green-600 font-semibold",onClick:function(){return h("Stop")},children:" START RECORD "}):Object(i.jsx)("button",{onClick:function(){return h("Start")},className:"font-semibold text-red-600",children:" STOP RECORD "})}),Object(i.jsx)("div",{className:"border-2 bg-blue-100 pl-3 rounded-md mx-2 my-2 text-blue-600 font-semibold ",children:"Start"==O?Object(i.jsx)("button",{className:"text-green-600 font-semibold",onClick:function(){return p("Stop")},children:" ENABLE SPRAY "}):Object(i.jsx)("button",{onClick:function(){return p("Start")},className:"font-semibold text-red-600",children:" DISABLE SPRAY "})})]})]})})};var B=function(){return Object(i.jsxs)("div",{className:"mt-5  h-80 border-2 max-w-xl mx-auto max-h-80 bg-white w-full rounded-xl shadow-md xl:max-w-2xl h-2/3 bg-gray-100",children:[Object(i.jsx)("div",{className:"text-center border-5  pl-3 rounded-sm mx-2 my-2 text-blue-600 font-semibold hover:bg-sky-700",children:"ROS LOG"}),Object(i.jsx)("div",{className:"h-5/6 overflow-y-auto mb-10"})]})};u()();var L=function(){return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)("div",{className:"2xl:px-10 grid grid-cols-1 md:grid-cols-1 md:max-h-xl  mt-2  lg:grid-cols-2",children:[Object(i.jsx)(v,{}),Object(i.jsx)(E,{})]}),Object(i.jsxs)("div",{className:"2xl:px-10 grid grid-cols-1 md:grid-cols-1 md:max-h-xl  mt-2 gap-1 lg:grid-cols-3",children:[Object(i.jsx)(U,{}),Object(i.jsx)(B,{}),Object(i.jsx)(D,{})]})]})};var G=function(e){var t=(new Date).toLocaleTimeString();return Object(i.jsxs)("div",{className:"border-2 max-w-xl mx-auto bg-white rounded-xl shadow-md overflow-hidden xl:max-w-2xl",children:[Object(i.jsxs)("div",{className:"text-center pl-2 pt-2 uppercase tracking-tight text-sm md:text-md text-blue-700 font-semibold",children:["CONNECTION STATUS : ",Object(i.jsxs)("span",{class:1==e.connectStatus?"text-green-500 ":"text-red-500 ",children:[" ",1==e.connectStatus?"Online":"Offline"," "]}),"    TIME : ",Object(i.jsxs)("span",{className:"text-green-500",children:[" ",t]})]}),Object(i.jsxs)("div",{className:"grid grid-cols-2 pb-3",children:[Object(i.jsx)("div",{className:"pl-5 pt-2 text-sm text-blue-700 font-light md:text-md ",children:Object(i.jsxs)("ul",{children:[Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-trailer"})," ROBOT MODE :"," ",Object(i.jsx)("span",{class:"text-green-400 ",children:" Auto "})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-bolt"})," Emergency Stop :"," ",Object(i.jsx)("span",{class:"text-green-400 ",children:"test"})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-video"})," CAMERA :"," ",Object(i.jsx)("span",{class:"text-red-400 ",children:" WORKING "})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-tint"})," SPRAY :"," ",Object(i.jsx)("span",{class:"text-green-400 ",children:" WORKING "})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-gamepad"})," Remote Control :"," ",Object(i.jsx)("span",{class:"text-red-400 ",children:" ON "})]})]})}),Object(i.jsx)("div",{className:"pt-2 text-sm md:text-md text-blue-700 font-light pl-10 ",children:Object(i.jsxs)("ul",{children:[Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-microchip"})," CPU USAGE :"," ",Object(i.jsxs)("span",{class:"text-red-400 ",children:[" ",e.hardwareStatus[0].cpuUsage,"% "]})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-memory"})," RAM USAGE :"," ",Object(i.jsxs)("span",{class:"text-red-400 ",children:[" ",e.hardwareStatus[0].ramUsage,"MB "]})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-car-battery"})," BATTERY :"," ",Object(i.jsxs)("span",{class:"text-green-400 ",children:[" ",e.hardwareStatus[0].battery,"% "]})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-temperature-low"})," TEMPERATURE :"," ",Object(i.jsxs)("span",{class:"text-green-400 ",children:[" ",e.hardwareStatus[0].temp,"\xb0C "]})]}),Object(i.jsxs)("li",{children:[Object(i.jsx)("i",{class:"fas fa-tint"})," SPRAY SHOTS :"," ",Object(i.jsx)("span",{class:"text-red-400 ",children:" 321/10000 "})]})]})})]})]})};var W=function(){var e=Object(c.useState)([{cpuUsage:0,ramUsage:0,battery:0,temp:0}]),t=Object(a.a)(e,2),s=t[0],n=t[1],o=Object(c.useState)(!1),d=Object(a.a)(o,2),b=d[0],j=d[1],u=Object(c.useState)(),m=Object(a.a)(u,2);return m[0],m[1],Object(c.useEffect)((function(){setInterval((function(){n([{cpuUsage:f.pc_status.cpuUsage,ramUsage:f.pc_status.ramUsage,battery:f.pc_status.battery,temp:f.pc_status.temp}]),j(f.connection_status)}),500)}),0),Object(i.jsx)(r.a,{children:Object(i.jsxs)(l.c,{children:[Object(i.jsxs)(l.a,{exact:!0,path:"/",children:[" ",Object(i.jsx)("div",{}),Object(i.jsx)(G,{hardwareStatus:s,connectStatus:b}),Object(i.jsx)(L,{})]}),Object(i.jsx)(l.a,{exact:!0,path:"/map",children:Object(i.jsx)(E,{})}),Object(i.jsx)(l.a,{exact:!0,path:"/test",children:Object(i.jsx)(F,{})})]})})},Y=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,161)).then((function(t){var s=t.getCLS,c=t.getFID,n=t.getFCP,o=t.getLCP,a=t.getTTFB;s(e),c(e),n(e),o(e),a(e)}))};o.a.render(Object(i.jsx)(W,{}),document.getElementById("root")),Y()},90:function(e,t,s){}},[[156,1,2]]]);
//# sourceMappingURL=main.70d1d8c3.chunk.js.map